---
title: 'Most Dangerous Weather Events'
author: "Katya Demidova"
date: "24 December 2015"
output: 
  html_document: 
    fig_height: 8
    fig_width: 10
    css: style.css
---

## Synopsis

The goal of this project is to analyze how severe weather events affect public health and economy of the United States. Our research addresses two main questions:

1. which types of events are most harmful with respect to population health?

2. which types of events have the greatest economic consequences?

We have found out that tornadoes are significantly more harmful to population health than any other type of events; floods, lightnings, excessive heat and thunderstorm winds cause many injuries and fatalities as well.

Floods, hurricanes/typhoons, and tornadoes cause most property damage (40-140 $ billions). And the most harmful for crops are drought, floods, and hurricanes/typhoons.

Summing up, typhoons, tornadoes, and floods cause huge both public health and economic problems for communities and municipalities, and preventing such outcomes to the extent possible is a key concern.

## Data

The data for this assignment (comma-separated-value file compressed via the bzip2 algorithm):

* [Storm Data][1] [47Mb]

Documentation of the database:

* National Weather Service [Storm Data Documentation][2]
* National Climatic Data Center Storm Events [FAQ][3]

[1]: https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2
[2]: https://d396qusza40orc.cloudfront.net/repdata%2Fpeer2_doc%2Fpd01016005curr.pdf
[3]: https://d396qusza40orc.cloudfront.net/repdata%2Fpeer2_doc%2FNCDC%20Storm%20Events-FAQ%20Page.pdf

The events in the database start in the year 1950 and end in November 2011. In the earlier years of the database there are generally fewer events recorded, most likely due to a lack of good records. More recent years should be considered more complete.

## Setting up

```{r, message = F}
library(dplyr)
library(tidyr)
library(ggplot2)
library(data.table)
library(R.utils)
library(knitr)

options(scipen = 1)
```

## Import the data

The analysis starts from loading the `.csv.bz2` file and unpacking it:

```{r, message=FALSE, warning=FALSE, cache=TRUE, results='hide'}
url <- "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2"

if (!file.exists("StormData.csv.bz2")) {
  download.file(url, "StormData.csv.bz2")
}

if (!file.exists("StormData.csv")) {
bunzip2("StormData.csv.bz2")
}

raw.storm <- fread("StormData.csv", na.strings = c("NA", ""))

rm(url)

```

Another way to import this data can be seen in Appendix. 

## Data Processing

Quick overview of the internal structure of the dataset and its first three rows:

```{r, cache=TRUE}
head(raw.storm, n = 3)
str(raw.storm)
```

### Selecting columns

There are 37 columns and 902297 rows in this dataset.

```{r, cache=TRUE}
dim(raw.storm)
names(raw.storm)
```

These column names were not obvious for me, so I've made an attempt to explain these variables. You can see the results in [this table](https://github.com/demidovakatya/repdata-peer-assessment-2/blob/master/variable_explanation.md).

These variables may be useful for further analysis:

Variable name | Class | Explanation
--------------|-------|------------
BGN_DATE | chr | Date when the event began
STATE | chr | State where the event happened
EVTYPE | chr | Event type
FATALITIES | num | Number of fatalities caused by the event
INJURIES | num | Number of injuries caused by the event
PROPDMG | num | Property damage caused by the event
PROPDMGEXP | chr | Property damage multiplier
CROPDMG | num | Crops damage caused by the event
CROPDMGEXP | chr | Crops damage multiplier

Create a new dataset from these columns:

```{r, cache=TRUE}
columns <- c("BGN_DATE", "EVTYPE", "FATALITIES", "INJURIES", 
             "PROPDMG", "CROPDMG", "PROPDMGEXP", "CROPDMGEXP")
storm <- select(tbl_df(raw.storm), one_of(columns))

colnames(storm) <- tolower(colnames(storm))

rm(raw.storm, columns)
```

### Removing old events

Information from the NOAA's website ([source](https://www.ncdc.noaa.gov/stormevents/details.jsp)):

Event Types Available: 

1. Tornado: From 1950 through 1954, only tornado events were recorded.

2. Tornado, Thunderstorm Wind and Hail: From 1955 through 1992, only tornado, thunderstorm wind and hail events were keyed from the paper publications into digital data. From 1993 to 1995, only tornado, thunderstorm wind and hail events have been extracted from the Unformatted Text Files.

3. All Event Types: From 1996 to present, 48 event types are recorded as defined in NWS Directive 10-1605. 

From this information, we can conclude that years 1950-1995 should be removed from the data set, otherwise the analysis can be incorrect.

```{r}
# convert bgn_date to date format
storm$bgn_date <- as.Date(storm$bgn_date, format = "%m/%d/%Y %H:%M:%S")

# subset only new data
storm <- subset(storm, bgn_date > as.Date("1996-01-01"))
```

### Damage cost multipliers

Convert multipliers in `propdmgexp` and `cropdmgexp` columns into numeric values and apply these multipliers:

```{r, cache=TRUE}

storm$propdmgexp <- toupper(storm$propdmgexp)
storm$propdmgexp[storm$propdmgexp == "0"] <- 1
storm$propdmgexp[storm$propdmgexp == "K"] <- 1000
storm$propdmgexp[storm$propdmgexp == "M"] <- 1000000
storm$propdmgexp[storm$propdmgexp == "B"] <- 1000000000
storm$propdmgexp <- as.numeric(storm$propdmgexp)
storm <- storm %>% mutate(propdmg=propdmg * propdmgexp)

storm$cropdmgexp <- toupper(storm$cropdmgexp)
storm$cropdmgexp[storm$cropdmgexp == "0"] <- 1
storm$cropdmgexp[storm$cropdmgexp == "K"] <- 1000
storm$cropdmgexp[storm$cropdmgexp == "M"] <- 1000000
storm$cropdmgexp[storm$cropdmgexp == "B"] <- 1000000000
storm$cropdmgexp <- as.numeric(storm$cropdmgexp)


storm <- storm %>% mutate(cropdmg=cropdmg * cropdmgexp)

# Remove ~dmgexp columns
storm <- storm %>% select(-ends_with("dmgexp"))
```
### Removing empty rows

Since we are not going to analyse lowest damage, we will remove rows where damage equals to 0:

```{r}
# replace NAs with 0
storm$propdmg[is.na(storm$propdmg)] <- 0
storm$cropdmg[is.na(storm$cropdmg)] <- 0

storm <- storm %>% subset(fatalities!=0 | injuries!=0 | propdmg!=0 | cropdmg!=0)
```

### Tidying event types

The last thing is to tidy up the `evtype` column.  Let's save it to a separate variable and then have a look at it:

```{r}
events <- storm$evtype
head(data.frame(table(events)), n=20)
```

At this point of our analysis, there are 174 different event types. But as we have mentioned before, there are only 48 types of weather events. A list of these event types is located [here](https://gist.github.com/demidovakatya/8bd24a471d36def5971e). 

There are so many unique values of `evtype` due to similar values like these:

- "Freezing rain"
- "Freezing Rain"
- "FREEZING RAIN"

or 

- BLOW OUT TIDE 
- BLOW OUT TIDES

Tidying up this column will make our analysis more accurate and trustworthy. To begin with, we will convert all values in `evtype` column to uppercase strings, trim them, and delete punctuation and digits.

```{r}

# trim, clean from punctuation
events <- toupper(events)
events <- gsub("[[:digit:]]+", "", events)
events <- gsub("&", " AND ", events)
events <- gsub("[[:punct:]]+", " ", events)
events <- gsub("^\\s+|\\s+$|\\s\\s+", "", events)
```

Next, we will replace incorrect values with the correct ones (from the NOAA paper) by performing code you can see in Appendix.

```{r replacement, echo=F, eval=TRUE}
events[events=="TSTM WIND" | events=="THUNDERSTORM" |
      events=="THUNDERSTORM WINDG" | events=="THUNDERSTORMS"] <- "THUNDERSTORM WIND"

events[events=="MARINE TSTM WIND"] <- "MARINE THUNDERSTORM WIND"

events[events=="COASTAL EROSION" | events=="COASTAL FLOODING EROSION" | events=="COASTAL FLOODING" | events=="COASTAL STORM" | events=="COASTALFLOODING EROSION" | events=="COASTALSTORM"] <- "COASTAL FLOOD"
events[events=="COLD TEMPERATURE" | events=="COLD WEATHER" | events=="COLD WIND CHILL" | events=="COLD"] <- "COLD/WIND CHILL"
events[events=="DAMAGING FREEZE"] <- "FROST/FREEZE"
events[events=="DOWNBURST" | events=="DRY MICROBURST"] <- "STRONG WIND"
events[events=="EROSION CSTL FLOOD"] <- "COASTAL FLOOD"
events[events=="EXTREME COLD WIND CHILL" | events=="EXTREME COLD" | events=="EXTREME WINDCHILL"] <- "EXTREME COLD/WIND CHILL"
events[events=="FLASH FLOOD FLOOD" | events=="FLASH FLOOD" | events=="FLOOD FLASH FLOOD" | events=="FLOOD"] <- "FLOOD/FLASH FLOOD"
events[events=="FROST FREEZE"] <- "FROST/FREEZE"
events[events=="FROST"] <- "FROST/FREEZE"
events[events=="HEAVY RAIN HIGH SURF"] <- "HEAVY RAIN"
events[events=="HEAVY SNOW SHOWER"] <- "HEAVY SNOW"
events[events=="HEAVY SURF AND WIND"] <- "HIGH SURF"
events[events=="HEAVY SURF HIGH SURF"] <- "HIGH SURF"
events[events=="HEAVY SURF"] <- "HIGH SURF"
events[events=="HIGH SURF ADVISORY"] <- "HIGH SURF"
events[events=="HIGH WINDG"] <- "HIGH WIND"
events[events=="HIGH WINDS"] <- "HIGH WIND"
events[events=="HURRICANE EDOUARD"] <- "HURRICANE/TYPHOON"
events[events=="HURRICANE TYPHOON"] <- "HURRICANE/TYPHOON"
events[events=="HURRICANE"] <- "HURRICANE/TYPHOON"
events[events=="ICE STORM"] <- "ICE STORM"
events[events=="RIP CURRENTS"] <- "RIP CURRENT"
events[events=="SMALL HAIL"] <- "HAIL"
events[events=="STRONG WINDS"] <- "STRONG WIND"
events[events=="TSTM WIND AND LIGHTNING"] <- "THUNDERSTORM WIND"
events[events=="TSTM WIND G"] <- "THUNDERSTORM WIND"
events[events=="TSTM WIND HAIL"] <- "THUNDERSTORM WIND"
events[events=="TSTM WINDG"] <- "THUNDERSTORM WIND"
events[events=="TYPHOON"] <- "HURRICANE/TYPHOON"
events[events=="VOLCANIC ASH"] <- "VOLCANIC ASH"
events[events=="WILD FOREST FIRE"] <- "WILDFIRE"
events[events=="WINTER WEATHER MIX"] <- "WINTER WEATHER"
events[events=="WINTRY MIX"] <- "WINTER WEATHER"
events[events=="AGRICULTURAL FREEZE"] <- "FROST/FREEZE"
events[events=="ASTRONOMICAL HIGH TIDE"] <- "HIGH SURF"
events[events=="BEACH EROSION"] <- "OTHER"
events[events=="BLACK ICE"] <- "OTHER"
events[events=="BLOWING DUST"] <- "DUST STORM"
events[events=="BLOWING SNOW"] <- "WINTER WEATHER"
events[events=="BRUSH FIRE"] <- "WILDFIRE"
events[events=="COLD AND SNOW"] <- "WINTER WEATHER"
events[events=="DAM BREAK"] <- "FLOOD"
events[events=="DENSE SMOKE"] <- "WILDFIRE"
events[events=="DROWNING"] <- "FLOOD"
events[events=="EARLY FROST"] <- "FROST/FREEZE"
events[events=="EXCESSIVE SNOW"] <- "HEAVY SNOW"
events[events=="EXTENDED COLD"] <- "EXTREME COLD/WIND CHILL"
events[events=="FALLING SNOW ICE"] <- "HAIL"
events[events=="FOG"] <- "DENSE FOG"
events[events=="FREEZE"] <- "FROST/FREEZE"
events[events=="FREEZING DRIZZLE"] <- "FROST/FREEZE"
events[events=="FREEZING RAIN"] <- "FROST/FREEZE"
events[events=="FREEZING SPRAY"] <- "FROST/FREEZE"
events[events=="GLAZE"] <- "FROST/FREEZE"
events[events=="GRADIENT WIND"] <- "STRONG WIND"
events[events=="GUSTY WIND"] <- "STRONG WIND"
events[events=="GUSTY WIND HAIL"] <- "STRONG WIND"
events[events=="GUSTY WIND HVY RAIN"] <- "STRONG WIND"
events[events=="GUSTY WIND RAIN"] <- "STRONG WIND"
events[events=="GUSTY WINDS"] <- "STRONG WIND"
events[events=="HARD FREEZE"] <- "FROST/FREEZE"
events[events=="HAZARDOUS SURF"] <- "HIGH SURF"
events[events=="HEAT WAVE"] <- "HEAT"
events[events=="HEAVY SEAS"] <- "HIGH SURF"
events[events=="HIGH SEAS"] <- "FLOOD"
events[events=="HIGH SWELLS"] <- "FLOOD"
events[events=="HIGH WATER"] <- "FLOOD"
events[events=="HYPERTHERMIA EXPOSURE"] <- "HEAT"
events[events=="HYPOTHERMIA EXPOSURE"] <- "COLD/WIND CHILL"
events[events=="ICE JAM FLOODMINOR"] <- "WINTER WEATHER"
events[events=="ICE ON ROAD"] <- "WINTER WEATHER"
events[events=="ICE ROADS"] <- "WINTER WEATHER"
events[events=="ICY ROADS"] <- "WINTER WEATHER"
events[events=="LAKE EFFECT SNOW"] <- "WINTER WEATHER"
events[events=="LAKESHORE FLOOD"] <- "LAKESHORE FLOOD"
events[events=="LANDSLIDES"] <- "LANDSLIDE"
events[events=="LANDSLUMP"] <- "OTHER"
events[events=="LANDSPOUT"] <- "TORNADO"
events[events=="LATE SEASON SNOW"] <- "HEAVY SNOW"
events[events=="LIGHT FREEZING RAIN"] <- "COLD/WIND CHILL"
events[events=="LIGHT SNOW"] <- "WINTER WEATHER"
events[events=="LIGHT SNOWFALL"] <- "WINTER WEATHER"
events[events=="MARINE ACCIDENT"] <- "OTHER"
events[events=="MICROBURST"] <- "STRONG WIND"
events[events=="MIXED PRECIP"] <- "OTHER"
events[events=="MIXED PRECIPITATION"] <- "OTHER"
events[events=="MUD SLIDE"] <- "MUDSLIDE"
events[events=="MUDSLIDES"] <- "MUDSLIDE"
events[events=="NON SEVERE WIND DAMAGE"] <- "HIGH WIND"
events[events=="NON TSTM WIND"] <- "HIGH WIND"
events[events=="RAIN"] <- "HEAVY RAIN"
events[events=="RAIN SNOW"] <- "WINTER WEATHER"
events[events=="RECORD HEAT"] <- "EXCESSIVE HEAT"
events[events=="RIVER FLOOD"] <- "FLOOD"
events[events=="RIVER FLOODING"] <- "FLOOD"
events[events=="ROCK SLIDE"] <- "LANDSLIDE"
events[events=="ROGUE WAVE"] <- "HIGH SURF"
events[events=="ROUGH SEAS"] <- "MARINE HIGH WIND"
events[events=="ROUGH SURF"] <- "HIGH SURF"
events[events=="SNOW"] <- "WINTER WEATHER"
events[events=="SNOW AND ICE"] <- "WINTER WEATHER"
events[events=="SNOW SQUALL"] <- "HEAVY SNOW"
events[events=="SNOW SQUALLS"] <- "HEAVY SNOW"
events[events=="STORM SURGE TIDE"] <- "COASTAL FLOOD"
events[events=="STORM SURGE"] <- "COASTAL FLOOD"
events[events=="TIDAL FLOODING"] <- "FLOOD"
events[events=="TORRENTIAL RAINFALL"] <- "HEAVY RAIN"
events[events=="UNSEASONABLE COLD"] <- "EXTREME COLD/WIND CHILL"
events[events=="UNSEASONABLY COLD"] <- "EXTREME COLD/WIND CHILL"
events[events=="UNSEASONABLY WARM"] <- "HEAT"
events[events=="UNSEASONAL RAIN"] <- "HEAVY RAIN"
events[events=="URBAN SML STREAM FLD"] <- "FLOOD"
events[events=="WARM WEATHER"] <- "HEAT"
events[events=="WET MICROBURST"] <- "STRONG WIND"
events[events=="WHIRLWIND"] <- "TORNADO"
events[events=="WIND"] <- "STRONG WIND"
events[events=="WIND AND WAVE"] <- "HIGH SURF"
events[events=="WIND DAMAGE"] <- "STRONG WIND"
events[events=="WINDS"] <- "STRONG WIND"

```

```{r}
unique(events)

# replace messy evtype variable with this new one
storm$evtype <- events
```

By the end of this data processing section we have removed ~700,000 rows with incomplete or irrelevant information, which should increase the productivity of following section.

The clean data set has `r nrow(storm)` observations of 6 variables:

```{r}
str(storm)
```

## Results

### Most harmful to population health events

```{r}
health <- storm %>% 
  group_by(evtype) %>% 
  summarise(fatalities = sum(fatalities), injuries = sum(injuries)) %>% 
  top_n(15, wt = fatalities + injuries)

ggplot(data = health, aes(evtype, fatalities + injuries)) + geom_bar(stat = "identity") + 
  coord_flip() + xlab("Event type") + ggtitle("15 events causing most harm to population health") 
```

Events causing most fatalities:

```{r}
storm %>% 
  group_by(evtype) %>% 
  summarise(fatalities = sum(fatalities)) %>% 
  top_n(10, wt = fatalities) %>% 
  arrange(desc(fatalities))
```

Events causing most injuries:

```{r}
storm %>% 
  group_by(evtype) %>% 
  summarise(injuries = sum(injuries)) %>% 
  top_n(10, wt = injuries) %>% 
  arrange(desc(injuries))
```

### Events causing most property damage:
```{r}
property <- storm %>% 
  group_by(evtype) %>%
  summarise(damage = sum(propdmg)) %>% 
  top_n(15, wt = damage) %>% 
  arrange(desc(damage))

ggplot(aes(evtype, damage/10^9, fill=evtype), data=property) + geom_bar(stat="identity") + 
  xlab("Event type")+ ylab("Property damage cost ($ billions)") + 
  ggtitle("15 events causing most property damage") + theme(legend.position="none") + coord_flip()
```

Events causing most property damage are: flood/flash flood, hurricane/typhoon, coastal flood, tornado, and hail.

### Events causing most crop damage:
```{r}
crop <- storm %>% group_by(evtype) %>% 
  summarise(damage=sum(cropdmg)) %>% 
  top_n(15, wt = damage) %>% 
  arrange(desc(damage))

ggplot(aes(evtype, damage/10^9, fill=evtype), data=crop) + geom_bar(stat="identity") + 
  xlab("Event type")+ ylab("Crop damage cost ($ billions)") + 
  ggtitle("15 events causing most crop damage") + theme(legend.position="none") + coord_flip()

```

Events causing most crop damage are: drought, flood/flash flood, hurricane/typhoon, hail, and frost/freeze.

## Conclusion

The most **harmful for population health** events are: tornado, flood/flash flood, excessive heat, thunderstorm wind, and lightning.

The greatest **economic consequences** have: drought, flood/flash flood, coastal flood hurricane/typhoon, tornado, hail, and frost/freeze. Floods and hurricanes/typhoons are harmful for both property and crops, while drought deals the most damage to crops and much less - to property.

## Appendix

### Import of the data

The CSV file is very large (561.6 MB), so to load the data for the first time we use `fread()` method. In R Documentation `fread {data.table}` is described as similar to `read.table` but faster and more convenient.

After reading in the original CSV file, we save the dataset as an RDS file so we could restore the dataset via `readRDS()`. `readRDS()` is considered faster than other `read` methods.

The following chunk of code checks if there is an RDS file (if there isn't, it creates it (from the CSV file which is created by unpacking the BZ2 package)) and loads the data into workspace.

```{r, eval=FALSE}
# Download and import the data

if (!file.exists("StormData.rds")) {
  # If we don't have the csv, we need to unpack the .bz2 file
  if (!file.exists("StormData.csv")) {
    # If we don't have the .bz2 file, we need to download it
    if (!file.exists("StormData.csv.bz2")) {
      download.file(url, "StormData.csv.bz2")
    }
    bunzip2("StormData.csv.bz2")
  }
  raw.storm <- fread("StormData.csv", na.strings = c("NA", ""))
  saveRDS(storm, "StormData.rds")
  file.remove("StormData.csv")
}

# Load the data into workspace unless it already exists
if (!exists("raw.storm")) {
  raw.storm <- readRDS("StormData.rds")
}

```

### Evtype replacement

```{r, ref.label="replacement", eval=FALSE, echo=TRUE}
events[events=="TSTM WIND" | events=="THUNDERSTORM" |
      events=="THUNDERSTORM WINDG" | events=="THUNDERSTORMS"] <- "THUNDERSTORM WIND"

events[events=="MARINE TSTM WIND"] <- "MARINE THUNDERSTORM WIND"

events[events=="COASTAL EROSION" | events=="COASTAL FLOODING EROSION" | events=="COASTAL FLOODING" | events=="COASTAL STORM" | events=="COASTALFLOODING EROSION" | events=="COASTALSTORM"] <- "COASTAL FLOOD"
events[events=="COLD TEMPERATURE" | events=="COLD WEATHER" | events=="COLD WIND CHILL" | events=="COLD"] <- "COLD/WIND CHILL"
events[events=="DAMAGING FREEZE"] <- "FROST/FREEZE"
events[events=="DOWNBURST" | events=="DRY MICROBURST"] <- "STRONG WIND"
events[events=="EROSION CSTL FLOOD"] <- "COASTAL FLOOD"
events[events=="EXTREME COLD WIND CHILL" | events=="EXTREME COLD" | events=="EXTREME WINDCHILL"] <- "EXTREME COLD/WIND CHILL"
events[events=="FLASH FLOOD FLOOD" | events=="FLASH FLOOD" | events=="FLOOD FLASH FLOOD" | events=="FLOOD"] <- "FLOOD/FLASH FLOOD"
events[events=="FROST FREEZE"] <- "FROST/FREEZE"
events[events=="FROST"] <- "FROST/FREEZE"
events[events=="HEAVY RAIN HIGH SURF"] <- "HEAVY RAIN"
events[events=="HEAVY SNOW SHOWER"] <- "HEAVY SNOW"
events[events=="HEAVY SURF AND WIND"] <- "HIGH SURF"
events[events=="HEAVY SURF HIGH SURF"] <- "HIGH SURF"
events[events=="HEAVY SURF"] <- "HIGH SURF"
events[events=="HIGH SURF ADVISORY"] <- "HIGH SURF"
events[events=="HIGH WINDG"] <- "HIGH WIND"
events[events=="HIGH WINDS"] <- "HIGH WIND"
events[events=="HURRICANE EDOUARD"] <- "HURRICANE/TYPHOON"
events[events=="HURRICANE TYPHOON"] <- "HURRICANE/TYPHOON"
events[events=="HURRICANE"] <- "HURRICANE/TYPHOON"
events[events=="ICE STORM"] <- "ICE STORM"
events[events=="RIP CURRENTS"] <- "RIP CURRENT"
events[events=="SMALL HAIL"] <- "HAIL"
events[events=="STRONG WINDS"] <- "STRONG WIND"
events[events=="TSTM WIND AND LIGHTNING"] <- "THUNDERSTORM WIND"
events[events=="TSTM WIND G"] <- "THUNDERSTORM WIND"
events[events=="TSTM WIND HAIL"] <- "THUNDERSTORM WIND"
events[events=="TSTM WINDG"] <- "THUNDERSTORM WIND"
events[events=="TYPHOON"] <- "HURRICANE/TYPHOON"
events[events=="VOLCANIC ASH"] <- "VOLCANIC ASH"
events[events=="WILD FOREST FIRE"] <- "WILDFIRE"
events[events=="WINTER WEATHER MIX"] <- "WINTER WEATHER"
events[events=="WINTRY MIX"] <- "WINTER WEATHER"
events[events=="AGRICULTURAL FREEZE"] <- "FROST/FREEZE"
events[events=="ASTRONOMICAL HIGH TIDE"] <- "HIGH SURF"
events[events=="BEACH EROSION"] <- "OTHER"
events[events=="BLACK ICE"] <- "OTHER"
events[events=="BLOWING DUST"] <- "DUST STORM"
events[events=="BLOWING SNOW"] <- "WINTER WEATHER"
events[events=="BRUSH FIRE"] <- "WILDFIRE"
events[events=="COLD AND SNOW"] <- "WINTER WEATHER"
events[events=="DAM BREAK"] <- "FLOOD"
events[events=="DENSE SMOKE"] <- "WILDFIRE"
events[events=="DROWNING"] <- "FLOOD"
events[events=="EARLY FROST"] <- "FROST/FREEZE"
events[events=="EXCESSIVE SNOW"] <- "HEAVY SNOW"
events[events=="EXTENDED COLD"] <- "EXTREME COLD/WIND CHILL"
events[events=="FALLING SNOW ICE"] <- "HAIL"
events[events=="FOG"] <- "DENSE FOG"
events[events=="FREEZE"] <- "FROST/FREEZE"
events[events=="FREEZING DRIZZLE"] <- "FROST/FREEZE"
events[events=="FREEZING RAIN"] <- "FROST/FREEZE"
events[events=="FREEZING SPRAY"] <- "FROST/FREEZE"
events[events=="GLAZE"] <- "FROST/FREEZE"
events[events=="GRADIENT WIND"] <- "STRONG WIND"
events[events=="GUSTY WIND"] <- "STRONG WIND"
events[events=="GUSTY WIND HAIL"] <- "STRONG WIND"
events[events=="GUSTY WIND HVY RAIN"] <- "STRONG WIND"
events[events=="GUSTY WIND RAIN"] <- "STRONG WIND"
events[events=="GUSTY WINDS"] <- "STRONG WIND"
events[events=="HARD FREEZE"] <- "FROST/FREEZE"
events[events=="HAZARDOUS SURF"] <- "HIGH SURF"
events[events=="HEAT WAVE"] <- "HEAT"
events[events=="HEAVY SEAS"] <- "HIGH SURF"
events[events=="HIGH SEAS"] <- "FLOOD"
events[events=="HIGH SWELLS"] <- "FLOOD"
events[events=="HIGH WATER"] <- "FLOOD"
events[events=="HYPERTHERMIA EXPOSURE"] <- "HEAT"
events[events=="HYPOTHERMIA EXPOSURE"] <- "COLD/WIND CHILL"
events[events=="ICE JAM FLOODMINOR"] <- "WINTER WEATHER"
events[events=="ICE ON ROAD"] <- "WINTER WEATHER"
events[events=="ICE ROADS"] <- "WINTER WEATHER"
events[events=="ICY ROADS"] <- "WINTER WEATHER"
events[events=="LAKE EFFECT SNOW"] <- "WINTER WEATHER"
events[events=="LAKESHORE FLOOD"] <- "LAKESHORE FLOOD"
events[events=="LANDSLIDES"] <- "LANDSLIDE"
events[events=="LANDSLUMP"] <- "OTHER"
events[events=="LANDSPOUT"] <- "TORNADO"
events[events=="LATE SEASON SNOW"] <- "HEAVY SNOW"
events[events=="LIGHT FREEZING RAIN"] <- "COLD/WIND CHILL"
events[events=="LIGHT SNOW"] <- "WINTER WEATHER"
events[events=="LIGHT SNOWFALL"] <- "WINTER WEATHER"
events[events=="MARINE ACCIDENT"] <- "OTHER"
events[events=="MICROBURST"] <- "STRONG WIND"
events[events=="MIXED PRECIP"] <- "OTHER"
events[events=="MIXED PRECIPITATION"] <- "OTHER"
events[events=="MUD SLIDE"] <- "MUDSLIDE"
events[events=="MUDSLIDES"] <- "MUDSLIDE"
events[events=="NON SEVERE WIND DAMAGE"] <- "HIGH WIND"
events[events=="NON TSTM WIND"] <- "HIGH WIND"
events[events=="RAIN"] <- "HEAVY RAIN"
events[events=="RAIN SNOW"] <- "WINTER WEATHER"
events[events=="RECORD HEAT"] <- "EXCESSIVE HEAT"
events[events=="RIVER FLOOD"] <- "FLOOD"
events[events=="RIVER FLOODING"] <- "FLOOD"
events[events=="ROCK SLIDE"] <- "LANDSLIDE"
events[events=="ROGUE WAVE"] <- "HIGH SURF"
events[events=="ROUGH SEAS"] <- "MARINE HIGH WIND"
events[events=="ROUGH SURF"] <- "HIGH SURF"
events[events=="SNOW"] <- "WINTER WEATHER"
events[events=="SNOW AND ICE"] <- "WINTER WEATHER"
events[events=="SNOW SQUALL"] <- "HEAVY SNOW"
events[events=="SNOW SQUALLS"] <- "HEAVY SNOW"
events[events=="STORM SURGE TIDE"] <- "COASTAL FLOOD"
events[events=="STORM SURGE"] <- "COASTAL FLOOD"
events[events=="TIDAL FLOODING"] <- "FLOOD"
events[events=="TORRENTIAL RAINFALL"] <- "HEAVY RAIN"
events[events=="UNSEASONABLE COLD"] <- "EXTREME COLD/WIND CHILL"
events[events=="UNSEASONABLY COLD"] <- "EXTREME COLD/WIND CHILL"
events[events=="UNSEASONABLY WARM"] <- "HEAT"
events[events=="UNSEASONAL RAIN"] <- "HEAVY RAIN"
events[events=="URBAN SML STREAM FLD"] <- "FLOOD"
events[events=="WARM WEATHER"] <- "HEAT"
events[events=="WET MICROBURST"] <- "STRONG WIND"
events[events=="WHIRLWIND"] <- "TORNADO"
events[events=="WIND"] <- "STRONG WIND"
events[events=="WIND AND WAVE"] <- "HIGH SURF"
events[events=="WIND DAMAGE"] <- "STRONG WIND"
events[events=="WINDS"] <- "STRONG WIND"

```