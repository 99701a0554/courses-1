---
title: "Statistical Inference Course Project Part 1"
author: "Katya Demidova"
date: "10 December 2015"
output: html_document
---

## Overview

The main goal of this document is to investigate the exponential distribution in R and compare it with the Central Limit Theorem. We'll illustrate via simulation and associated explanatory text the properties of the distribution of the mean of 40 exponentials.

## Simulation

Set the workspace
```{r}
library(ggplot2)
```

The exponential distribution can be simulated in R with `rexp(n, lambda)` where `lambda` is the rate parameter. 

The requirements are:
- Set `lambda = 0.2` for all of the simulations.
- Investigate the distribution of averages of 40 exponentials.
- Do a thousand simulations.

```{r}
set.seed(11)

nosim <- 1000
n <- 40
lambda <- 0.2

# generate simulations
sims <- data.frame(replicate(nosim, rexp(n, lambda)))

# calculate the averages
means <- data.frame(sapply(sims, mean))

ggplot(data = means, aes(x = means)) + 
  geom_bar(binwidth = 0.1, aes(fill=..count..)) +  
  ggtitle("Distribution of simulated averages of 40 exponentials")
```

## Sample Mean versus Theoretical Mean

The mean of exponential distribution is `1 / lambda`. So, in our case it would be:

```{r}
theor.mean <- 1 / lambda
theor.mean
```

Next, we will evaluate the sample mean:
```{r}
sample.mean <- mean(means$means)
sample.mean
```

Let's add the sample mean and the theoretical mean to the plot we've constructed before:

```{r}
ggplot(data = means, aes(x = means)) + 
  geom_bar(binwidth = 0.1, aes(fill=..count..)) + 
  geom_vline(aes(xintercept = sample.mean), colour="black", alpha=1, size = 1) +
  geom_vline(aes(xintercept = theor.mean), colour="white", alpha=0.75, size = 1) + 
  ggtitle("Sample mean (black) vs. Theoretical mean (white)")
```

The center of mean distributions (`r sample.mean`) is very close to the theoretical mean (`r theor.mean`). 

## Sample Variance versus Theoretical Variance

Sample variance of averages of simulations:

```{r}
sample.sd <- sd(means$means)
sample.variance <- var(means$means)
sample.variance
```

The standard deviation of exponential distribution is `1 / lambda`. So, theoretical standard deviation of the sample means would equal to `(1 / lambda) / sqrt(n)`, where `n` is the number of exponentials (which is 40).

Theoretical variance of the sample means:

```{r}
theor.sd <- (1 / lambda) / sqrt(n)
theor.variance <- ((1 / lambda) / sqrt(n)) ^ 2 
```

Include figures (output from R) with titles. Highlight the variances you are comparing. Include text that explains your understanding of the differences of the variances.

## Distribution

Via figures and text, explain how one can tell the distribution is approximately normal.