---
title: "Statistical Inference Course Project Part 2"
author: "Katya Demidova"
date: "10 December 2015"
output: html_document
---

## Overview

In this part of the course project we're going to analyze the ToothGrowth data from the R `datasets` package. Description of this data set: the response is the length of odontoblasts (teeth) in each of 10 guinea pigs at each of three dose levels of Vitamin C (0.5, 1, and 2 mg) with each of two delivery methods (orange juice or ascorbic acid).

## Loading the data; basic summary

```{r}
library(ggplot2)
library(dplyr)
options(scipen=99)
```
Let us load the data set and perform some basic exploratory data analyses.

```{r}
library(datasets)
tg <- ToothGrowth
str(tg)
```

The ToothGrowth data is a data frame with 60 observations of 3 variables:

* `len`: tooth length (numeric),
* `supp`: supplement type / delivery method (factor with 2 levels `OJ` and `VC`, orange juice and ascorbic acid respectively),
* `dose`: dose of Vitamin C in miligrams (numeric).

Basic summary of data:

```{r}
head(tg)

summary(tg$len)
table(tg$supp)
table(tg$dose) # looks like factor
```

Though the `dose` variable is numeric in the original data set, we think it would be more convenient if we coerced this variable to a factor:
```{r}
tg$dose <- as.factor(tg$dose)
str(tg)
```

## Exploratory data analysis

```{r}
ggplot(data = tg, aes(supp, len)) + geom_boxplot(aes(fill = supp)) + ggtitle("Tooth growth by supplement type") + ylab("Tooth length") + xlab("Supplement type (orange juice/ascorbic acid)")

ggplot(data = tg, aes(dose, len)) + geom_boxplot(aes(fill = dose)) + ggtitle("Tooth growth by dose") + ylab("Tooth length") + xlab("Dose of Vitamin C (miligrams)")

ggplot(data = tg, aes(dose, len)) + geom_point(aes(colour = supp), size=4) + ggtitle("Tooth growth by dose of Vitamin C\nwith different delivery methods") + ylab("tooth length") + facet_grid(. ~ supp)
```

The plots above could help us with comparing tooth growth by `supp` and `dose`:

* it is clear from the plots that the higher the dose, the larger the teeth, in other words, it looks like there is a positive correlation between dose level and tooth length in guinea pigs;
* we might also make an assumption that orange juice causes larger tooth growth than ascorbic acid.

## Statistical Inference

### Tooth growth by dose level

As mentioned above, there seems to be a positive correlation between dose level and tooth length in guinea pigs. Mean values of tooth length by dose:

```{r}
tg %>% group_by(dose) %>% summarise(mean(len))
```

To compare tooth growth by `dose` and check if there is a statistically significant difference between the means, we will use t-tests:

```{r}
with(tg, t.test(len[dose=="0.5"], len[dose=="1"]))
with(tg, t.test(len[dose=="1"], len[dose=="2"]))
with(tg, t.test(len[dose=="0.5"], len[dose=="2"]))
```

P-values of these t-tests, respectively:

```{r}
with(tg, t.test(len[dose=="0.5"], len[dose=="1"]))$p.value
with(tg, t.test(len[dose=="1"], len[dose=="2"]))$p.value
with(tg, t.test(len[dose=="0.5"], len[dose=="2"]))$p.value
```

From these numbers, we can make a conclusion that **dosage of Vitamin C affects tooth growth in guinea pigs**.

### Tooth growth by supplement type

We have made an assumption that that orange juice causes larger tooth growth than ascorbic acid. Mean values of tooth length by supplement type:

```{r}
tg %>% group_by(supp) %>% summarise(mean(len))
```

To compare tooth growth by `supp` and check if there is a statistically significant difference between the means, we will use a t-test:

```{r}
with(tg, t.test(len[supp=="OJ"], len[supp=="VC"]))
```

The resulting p-value is `0.06063`. Though it is very close to `0.05` (most common alpha-level), the difference between the means is **not** significant. So, **delivery method doesn't affect tooth growth in guinea pigs**.

### Tooth growth by supplement type and dosage

Now, let us compare tooth growth by delivery method (`supp`) in groups with different dosage:

```{r}
with(tg, t.test(len[supp=="OJ" & dose=="0.5"], len[supp=="VC" & dose=="0.5"]))$p.value
with(tg, t.test(len[supp=="OJ" & dose=="1"], len[supp=="VC" & dose=="1"]))$p.value
with(tg, t.test(len[supp=="OJ" & dose=="2"], len[supp=="VC" & dose=="2"]))$p.value
```

As we can see, delivery method **does affect** tooth growth in guinea pigs when dosage is 0.5 or 1, with **orange juice causing more tooth growth**. However, **when dosage is 2 miligrams, orange juice does not significantly differ from ascorbic acid**. If we take into consideration the fact that this dosage causes largest tooth growth, these two supplement types are equally successful.