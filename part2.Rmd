---
title: "Statistical Inference Course Project Part 2"
author: "Katya Demidova"
date: "26 December 2015"
output: 
  pdf_document: 
    fig_height: 3
    fig_width: 5
---

## Overview

In this part of the course project we're going to use the ToothGrowth data from the R `datasets` package. We will analyse if the response is the length of odontoblasts (teeth) in each of 10 guinea pigs is different:

* at each of three dose levels of Vitamin C (0.5, 1, and 2 mg),
* with each of two delivery methods (orange juice or ascorbic acid).

## Exploratory data analysis

```{r start, echo = F, message = F}
library(ggplot2)
library(dplyr)
options(scipen=99)
library(datasets)
tg <- ToothGrowth
```

The ToothGrowth data is a data frame with 60 observations of 3 variables:

* `len`: tooth length (numeric),
* `supp`: supplement type / delivery method (factor with 2 levels `OJ` and `VC`, orange juice and ascorbic acid respectively),
* `dose`: dose of Vitamin C in miligrams (numeric). This variable is factorised for convenience.

Basic summary of data can be seen in Appendix.

```{r, echo=F}
tg$dose <- as.factor(tg$dose)
```

```{r plot3, echo=F, fig.align='center'}
ggplot(data = tg, aes(dose, len)) + geom_point(aes(colour = supp), size=3) + ggtitle("Tooth growth by dose of Vitamin C\nwith different delivery methods") + ylab("tooth length") + facet_grid(. ~ supp)
```

The plot above could help us with comparing tooth growth by `supp` and `dose`:

* it is clear from the plot that the higher the dose, the larger the teeth, in other words, it looks like there is a positive correlation between dose level and tooth length in guinea pigs;
* we might also make an assumption that orange juice causes larger tooth growth than ascorbic acid.

## Statistical Inference

### Tooth growth by dose level

As mentioned above, there seems to be a positive correlation between dose level and tooth length in guinea pigs. Mean values of tooth length by dose:

```{r, echo=F}
tg %>% group_by(dose) %>% summarise(mean(len))
```

To compare tooth growth by `dose` and check if there is a statistically significant difference between the means, we will use t-tests (full results can be seen in Appendix).

```{r bydose, results='hide'}
with(tg, t.test(len[dose=="0.5"], len[dose=="1"]))
with(tg, t.test(len[dose=="1"], len[dose=="2"]))
with(tg, t.test(len[dose=="0.5"], len[dose=="2"]))
```

P-values of these t-tests, respectively:

```{r pvalues, echo=F}
with(tg, t.test(len[dose=="0.5"], len[dose=="1"]))$p.value
with(tg, t.test(len[dose=="1"], len[dose=="2"]))$p.value
with(tg, t.test(len[dose=="0.5"], len[dose=="2"]))$p.value
```

From these numbers, we can make a conclusion that **dosage of Vitamin C affects tooth growth in guinea pigs**.

### Tooth growth by supplement type

We have made an assumption that that orange juice causes larger tooth growth than ascorbic acid. Mean values of tooth length by supplement type:

```{r, echo=F}
tg %>% group_by(supp) %>% summarise(mean(len))
```

To compare tooth growth by `supp` and check if there is a statistically significant difference between the means, we will use a t-test:

```{r}
with(tg, t.test(len[supp=="OJ"], len[supp=="VC"]))
```

The resulting p-value is `0.06063`. Though it is very close to `0.05` (most common alpha-level), the difference between the means is **not** significant. So, **delivery method doesn't affect tooth growth in guinea pigs**.

### Tooth growth by supplement type and dosage

Now, let us compare tooth growth by delivery method (`supp`) in groups with different dosage:

```{r by.supp, echo=T, results='hold'}
with(tg, t.test(len[supp=="OJ" & dose=="0.5"], len[supp=="VC" & dose=="0.5"]))$p.value
with(tg, t.test(len[supp=="OJ" & dose=="1"], len[supp=="VC" & dose=="1"]))$p.value
with(tg, t.test(len[supp=="OJ" & dose=="2"], len[supp=="VC" & dose=="2"]))$p.value
```

As we can see, delivery method **does affect** tooth growth in guinea pigs when dosage is 0.5 or 1, with **orange juice causing more tooth growth**. However, **when dosage is 2 miligrams, orange juice does not significantly differ from ascorbic acid**. If we take into consideration the fact that this dosage causes largest tooth growth, these two supplement types are equally successful.

## Appendix

### Setting the workplace; loading the data
```{r, ref.label="start", eval = F}
library(ggplot2)
library(dplyr)
options(scipen=99)
library(datasets)
tg <- ToothGrowth
```

### Basic summary of the data
```{r, results='hold'}
str(tg)
head(tg)
summary(tg)
```

### Plots
```{r, eval=F}
ggplot(data = tg, aes(dose, len)) + 
  geom_point(aes(colour = supp), size=3) + 
  ggtitle("Tooth growth by dose of Vitamin C\nwith different delivery methods") + 
  ylab("tooth length") + facet_grid(. ~ supp)
```
```{r, fig.align='center'}
ggplot(data = tg, aes(dose, len)) + 
  geom_boxplot(aes(fill = dose)) + 
  ggtitle("Tooth growth by dose") + 
  ylab("Tooth length") + xlab("Dose of Vitamin C (miligrams)")
```
```{r, fig.align='center'}
ggplot(data = tg, aes(supp, len)) + 
  geom_boxplot(aes(fill = supp)) + 
  ggtitle("Tooth growth by supplement type") + 
  ylab("Tooth length") + xlab("Supplement type (orange juice/ascorbic acid)")
```

### Sources for "Tooth Growth by Dose Level" section
```{r, ref.label="bydose", eval=F}
with(tg, t.test(len[dose=="0.5"], len[dose=="1"]))
with(tg, t.test(len[dose=="1"], len[dose=="2"]))
with(tg, t.test(len[dose=="0.5"], len[dose=="2"]))
```
```{r, ref.label="pvalues", eval=F}
with(tg, t.test(len[dose=="0.5"], len[dose=="1"]))$p.value
with(tg, t.test(len[dose=="1"], len[dose=="2"]))$p.value
with(tg, t.test(len[dose=="0.5"], len[dose=="2"]))$p.value
```

```{r, ref.label="by.supp", eval=F}
with(tg, t.test(len[supp=="OJ" & dose=="0.5"], len[supp=="VC" & dose=="0.5"]))$p.value
with(tg, t.test(len[supp=="OJ" & dose=="1"], len[supp=="VC" & dose=="1"]))$p.value
with(tg, t.test(len[supp=="OJ" & dose=="2"], len[supp=="VC" & dose=="2"]))$p.value
```
